<!DOCTYPE html>
<html>
<head>
    <title>Test Notes Toggle</title>
    <style>
        .note-content.editing .note-preview { display: none; }
        .note-content.editing .note-textarea { display: block; }
        .note-content:not(.editing) .note-preview { display: block; }
        .note-content:not(.editing) .note-textarea { display: none; }
        .note-preview { border: 1px solid #ccc; padding: 10px; margin: 10px 0; background: #f9f9f9; }
        .note-textarea { width: 100%; height: 100px; margin: 10px 0; border: 1px solid #ccc; padding: 5px; }
        .dragging { border-color: #007bff; background: #e3f2fd; }
    </style>
</head>
<body>
    <h1>Test Notes Toggle Functionality</h1>
    <div id="note-content_test" class="note-content">
        <div id="note-preview_test" class="note-preview">Preview: No notes yet. Click Edit to add some.</div>
        <textarea id="note-textarea_test" class="note-textarea" placeholder="Enter notes in Markdown format...

You can:
- Paste images directly (Ctrl+V)
- Drag and drop images
- Use **bold**, *italic*, lists, etc." style="display: none;">Test content</textarea>
    </div>
    <button onclick="toggleNoteEdit('test')">Toggle Edit Mode</button>
    <p><strong>Instructions:</strong> Click "Toggle Edit Mode" to switch between preview and edit mode. In edit mode, you should be able to type and paste images.</p>

    <script>
        function toggleNoteEdit(id) {
            const content = document.getElementById(`note-content_${id}`);
            const preview = document.getElementById(`note-preview_${id}`);
            const textarea = document.getElementById(`note-textarea_${id}`);

            if (content && preview && textarea) {
                const isEditing = content.classList.contains('editing');

                if (isEditing) {
                    // Switch to preview mode
                    content.classList.remove('editing');
                    preview.style.display = 'block';
                    textarea.style.display = 'none';
                    console.log('Switched to preview mode');
                } else {
                    // Switch to edit mode
                    content.classList.add('editing');
                    preview.style.display = 'none';
                    textarea.style.display = 'block';

                    // Ensure textarea is interactive
                    textarea.disabled = false;
                    textarea.readOnly = false;
                    textarea.style.pointerEvents = 'auto';

                    // Focus with a small delay
                    setTimeout(() => {
                        textarea.focus();
                        textarea.scrollIntoView({ behavior: 'smooth', block: 'center' });
                        console.log('Textarea focused and should be interactive');
                    }, 50);
                }
            }
        }

        // Setup image paste functionality (simplified for testing)
        function setupImagePaste(textarea) {
            textarea.addEventListener('paste', (e) => {
                const items = e.clipboardData.items;
                for (let item of items) {
                    if (item.type.indexOf('image') !== -1) {
                        e.preventDefault();
                        console.log('Image paste detected - would upload image here');
                        // Simulate inserting image markdown
                        const cursorPos = textarea.selectionStart;
                        const textBefore = textarea.value.substring(0, cursorPos);
                        const textAfter = textarea.value.substring(cursorPos);
                        textarea.value = textBefore + '![Pasted Image](image-url)' + textAfter;
                        break;
                    }
                }
            });

            textarea.addEventListener('dragover', (e) => {
                e.preventDefault();
                textarea.classList.add('dragging');
            });

            textarea.addEventListener('dragleave', () => {
                textarea.classList.remove('dragging');
            });

            textarea.addEventListener('drop', (e) => {
                e.preventDefault();
                textarea.classList.remove('dragging');
                console.log('Image drop detected - would upload image here');
            });
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            const textarea = document.getElementById('note-textarea_test');
            setupImagePaste(textarea);
        });
    </script>
</body>
</html></content>
<parameter name="filePath">c:\Users\Andreas\Desktop\Projects\SMAX-Upgrade-Tool\test_notes.html